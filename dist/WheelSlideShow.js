var MasterThetaLineWidth=3,MasterThetaLineColor="purple",pointWidth=2,LineWidth=.5,pointBegin=0,pointEnd=2*Math.PI,LineColor="rgba(255,255,255,0.8)",pointColor="#111",marginColor="rgba(255,255,255,0.5)";function RenderGrid(){Render_WidgetCircle(),Render_SubSectionCenterLines(),Render_SubSectionLines(),Render_CenterButtonPadding(),Render_SubSectionPoints(),Render_SubSectionPictureFrames(),Render_MasterThetaLine(),Render_CenterPoint()}function Render_WidgetCircle(){var e=getContext();e.beginPath(),e.arc(CenterX,CenterY,WheelRadius,pointBegin,pointEnd),e.lineWidth=LineWidth,e.strokeStyle=LineColor,e.stroke()}function Render_SubSectionCenterLines(){for(var e=0;e<Slides.length;++e)Render_SubSectionCenterLine(Slides[e].CurrentTheta)}function Render_SubSectionCenterLine(e){var t=getContext();t.beginPath(),t.moveTo(CenterX,CenterY),x=CenterX-WheelRadius*Math.cos(e),y=CenterY-WheelRadius*Math.sin(e),t.lineTo(x,y),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke()}function Render_SubSectionLines(){for(var e=0;e<Slides.length;++e)Render_SubSectionLine(Slides[e].CurrentTheta+1/SubDivisions*Math.PI)}function Render_SubSectionLine(e){var t=getContext();t.beginPath(),t.moveTo(CenterX,CenterY),x=CenterX-WheelRadius*Math.cos(e),y=CenterY-WheelRadius*Math.sin(e),t.lineTo(x,y),t.lineWidth=SlidePadding*(11/6),t.strokeStyle=marginColor,t.stroke()}function Render_CenterButtonPadding(){var e=getContext();e.beginPath();var t=2*Math.PI;e.arc(CenterX,CenterY,CenterPaddingRadius,0,t),e.lineWidth=LineWidth,e.strokeStyle=LineColor,e.stroke()}function Render_SubSectionPoints(){for(var e=0;e<Slides.length;++e)Render_SubSectionPoint(Slides[e])}function Render_SubSectionPoint(e){IsRounded?Render_SlidePivotPoint(e):(Render_SlideBaseCenterPoint(e),Render_SlideBaseLeftPoint(e),Render_SlideBaseRightPoint(e),Render_SlideTopCenterPoint(e),Render_SlideTopLeftPoint(e),Render_SlideTopRightPoint(e),Render_SlideCenterPoint(e))}function Render_SlidePivotPoint(e){var t=getContext();t.beginPath(),t.arc(e.SlidePivotPointX,e.SlidePivotPointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideBaseCenterPoint(e){var t=getContext();t.beginPath(),t.arc(e.SlideBasePointX,e.SlideBasePointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideBaseLeftPoint(e){var t=getContext();t.beginPath(),t.arc(e.BaseLeftPointX,e.BaseLeftPointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideBaseRightPoint(e){var t=getContext();t.beginPath(),t.arc(e.BaseRightPointX,e.BaseRightPointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideTopCenterPoint(e){var t=getContext();t.beginPath(),t.arc(e.SlideTopPointX,e.SlideTopPointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideTopLeftPoint(e){var t=getContext();t.beginPath(),t.arc(e.TopLeftPointX,e.TopLeftPointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideTopRightPoint(e){var t=getContext();t.beginPath(),t.arc(e.TopRightPointX,e.TopRightPointY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SlideCenterPoint(e){var t=getContext();t.beginPath(),t.arc(e.CenterX,e.CenterY,pointWidth,pointBegin,pointEnd),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fill()}function Render_SubSectionPictureFrames(){for(var e=0;e<Slides.length;++e)Render_SubSectionPictureFrame(Slides[e])}function Render_SubSectionPictureFrame(e){var t=getContext();t.beginPath(),t.rect(e.CenterX-MinImageDimension/2,e.CenterY-MinImageDimension/2,MinImageDimension,MinImageDimension),t.lineWidth=LineWidth,t.strokeStyle=LineColor,t.stroke(),t.fillStyle="rgba(0,0,0,0)",t.fill()}function Render_MasterThetaLine(){var e=getContext();e.beginPath(),e.moveTo(CenterX,CenterY),x=CenterX-WheelRadius*Math.cos(MasterTheta),y=CenterY-WheelRadius*Math.sin(MasterTheta),e.lineTo(x,y),e.lineWidth=MasterThetaLineWidth,e.strokeStyle=MasterThetaLineColor,e.stroke()}function Render_CenterPoint(){var e=getContext();e.beginPath(),e.arc(CenterX,CenterY,pointWidth,pointBegin,pointEnd),e.lineWidth=LineWidth,e.strokeStyle=LineColor,e.stroke(),e.fill()}function RenderLabels(){for(var e=0;e<Slides.length;++e)null!=Slides[e].Image&&RenderLabel(Slides[e])}function RenderLabel(e){var t=getContext();t.font=Styles.Label_Font,t.fillStyle=Styles.Label_Fill,t.textAlign=Styles.Label_Align,t.strokeStyle=Styles.Label_Stroke;var n=e.Image.getAttribute("alt");t.fillText(n,e.CenterX,e.CenterY),t.strokeText(n,e.CenterX,e.CenterY)}var Styles={};function getCollection(){return document.getElementById("slideshow-wheel-widget-collection")}function getStyles(){return document.getElementById("slideshow-wheel-widget-style")}function ReloadUserInputs(){GetProvidedParams(),GetStyles(),DeriveVariables(),LoadImages(),CreateSlides()}function GetProvidedParams(){var e=getCanvas();if(null!=e){var t=JSON.parse(e.getAttribute("value"));CenterX=t.CenterX||0,CenterY=t.CenterY||0,WheelRadius=t.WheelRadius||200,CenterPaddingRadius=t.CenterPaddingRadius||100,GridMode=t.GridMode||!1,IsRounded=t.IsRounded||!1,HasLabels=t.HasLabels||!1,WheelBeginTheta=t.WheelBeginTheta||0,WheelEndTheta=t.WheelEndTheta||Math.PI,SubDivisions=t.SubDivisions||7,SlidePadding=t.SlidePadding||10}}function GetStyles(){try{Styles=[];var e=getStyles();if(null!=e){var t=JSON.parse(e.getAttribute("value"));Styles.Label_LineWidth=t.Label_LineWidth||.25,Styles.Label_Font=t.Label_Font="35px Elephant",Styles.Label_Fill=t.Label_Fill="#628edd",Styles.Label_Stroke=t.Label_Stroke="black",Styles.Label_Align=t.Label_Align="center"}else Styles.Label_LineWidth=.25,Styles.Label_Font="35px Elephant",Styles.Label_Fill="#628EDD",Styles.Label_Stroke="black",Styles.Label_Align="center"}catch(e){myAlert("GetStyles():"),myAlert(e)}}var frameBorderWidth=1,frameBorderColor="#DDD",ImageCount=0,RenderedImageCount=0,MinImageDimension=0,Images=[],RenderedImages=[];function LoadImages(){Images=[],RenderedImages=[],ImageCount=0,RenderedImageCount=0;var e=getCollection();if(null!=e)for(var t=e.firstChild;null!==t;t=t.nextSibling)"IMG"==t.tagName&&(Images.push(t),++ImageCount)}function CreateSlides(){try{Slides=[];for(var e=0;e<SubDivisions;++e){var t=e/SubDivisions*(2*Math.PI),n=WheelEndTheta-HalfTheta-t,i={Image:null,ImageScaleRatio:0,ThetaOffset:n,CurrentTheta:n,CenterX:0,CenterY:0,SlideBasePointX:0,SlideBasePointY:0,SlideTopPointX:0,SlideTopPointY:0,BaseLeftPointX:0,BaseLeftPointY:0,BaseRightPointX:0,BaseRightPointY:0,TopLeftPointX:0,TopLeftPointY:0,TopRightPointX:0,TopRightPointY:0,Style:null};Slides.push(i)}}catch(e){myAlert("GetMinImageDimension(): "+e.Message)}}function UpdateSlides(){try{TestImageOrder();for(var e=0;e<Slides.length;++e)Slides[e].CurrentTheta+HalfTheta>WheelBeginTheta&&Slides[e].CurrentTheta-HalfTheta<WheelEndTheta||Slides[e].CurrentTheta+HalfTheta>WheelBeginTheta+2*Math.PI&&Slides[e].CurrentTheta-HalfTheta<WheelEndTheta+2*Math.PI||Slides[e].CurrentTheta+HalfTheta>WheelBeginTheta-2*Math.PI&&Slides[e].CurrentTheta-HalfTheta<WheelEndTheta-2*Math.PI?(null==Slides[e].Image&&StepSize>0&&(Slides[e].Image=AddRenderedImage()),null==Slides[e].Image&&StepSize<0&&(Slides[e].Image=AddRenderedImageReverse())):(null!=Slides[e].Image&&StepSize>0&&(Slides[e].Image=RemoveRenderedImage()),null!=Slides[e].Image&&StepSize<0&&(Slides[e].Image=RemoveRenderedImageReverse())),Slides[e].CurrentTheta=Slides[e].ThetaOffset+MasterTheta,UpdateSlidePoints(e),GetMinImageDimension()}catch(e){myAlert("UpdateSlides():"),myAlert(e)}}function UpdateSlidePoints(e){try{Slides[e].SlideBasePointX=CenterX-CenterPaddingRadius*Math.cos(Slides[e].CurrentTheta),Slides[e].SlideBasePointY=CenterY-CenterPaddingRadius*Math.sin(Slides[e].CurrentTheta),Slides[e].BaseLeftPointX=Slides[e].SlideBasePointX-(HalfBaseLength-SlidePadding)*Math.sin(Slides[e].CurrentTheta),Slides[e].BaseLeftPointY=Slides[e].SlideBasePointY+(HalfBaseLength-SlidePadding)*Math.cos(Slides[e].CurrentTheta),Slides[e].BaseRightPointX=Slides[e].SlideBasePointX+(HalfBaseLength-SlidePadding)*Math.sin(Slides[e].CurrentTheta),Slides[e].BaseRightPointY=Slides[e].SlideBasePointY-(HalfBaseLength-SlidePadding)*Math.cos(Slides[e].CurrentTheta),Slides[e].SlideTopPointX=CenterX-WheelRadius*Math.cos(Slides[e].CurrentTheta),Slides[e].SlideTopPointY=CenterY-WheelRadius*Math.sin(Slides[e].CurrentTheta),Slides[e].TopLeftPointX=Slides[e].SlideTopPointX-(HalfTopLength-SlidePadding)*Math.sin(Slides[e].CurrentTheta),Slides[e].TopLeftPointY=Slides[e].SlideTopPointY+(HalfTopLength-SlidePadding)*Math.cos(Slides[e].CurrentTheta),Slides[e].TopRightPointX=Slides[e].SlideTopPointX+(HalfTopLength-SlidePadding)*Math.sin(Slides[e].CurrentTheta),Slides[e].TopRightPointY=Slides[e].SlideTopPointY-(HalfTopLength-SlidePadding)*Math.cos(Slides[e].CurrentTheta),Slides[e].CenterX=(Slides[e].SlideBasePointX+Slides[e].SlideTopPointX)/2,Slides[e].CenterY=(Slides[e].SlideBasePointY+Slides[e].SlideTopPointY)/2}catch(e){myAlert("UpdateSlidePoints():"),myAlert(e)}}function AddRenderedImage(){try{var e=Images.shift();return RenderedImages.unshift(e),++RenderedImageCount,--ImageCount,e}catch(e){myAlert("AddRenderedImage(): "+e.Message)}}function RemoveRenderedImage(){try{return Images.push(RenderedImages.pop()),++ImageCount,--RenderedImageCount,null}catch(e){myAlert("RemoveRenderedImage(): "+e.Message)}}function AddRenderedImageReverse(){try{var e=Images.pop();return RenderedImages.push(e),++RenderedImageCount,--ImageCount,e}catch(e){myAlert("AddRenderedImageReverse(): "+e.Message)}}function RemoveRenderedImageReverse(){try{return Images.unshift(RenderedImages.shift()),++ImageCount,--RenderedImageCount,null}catch(e){myAlert("RemoveRenderedImageReverse(): "+e.Message)}}function GetMinImageDimension(){try{var e,t;e=Math.abs(Slides[0].TopRightPointX-Slides[0].BaseLeftPointX),t=Math.abs(Slides[0].TopRightPointY-Slides[0].BaseLeftPointY);var n=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));MinImageDimension=1.1*n}catch(e){myAlert("GetMinImageDimension():"),myAlert(e)}}function RenderSlides(){try{for(var e=0;e<Slides.length;++e)null!=Slides[e].Image&&(IsRounded?RenderRoundedSlide(Slides[e]):RenderSlide(Slides[e]))}catch(e){myAlert("RenderSlides():"),myAlert(e)}}function RenderRoundedSlide(e){try{var t=getContext();t.save(),t.beginPath();var n,i=Math.asin(SlidePadding/WheelRadius)+Math.PI;t.arc(CenterX,CenterY,WheelRadius,e.CurrentTheta-HalfTheta+i,e.CurrentTheta+HalfTheta-i),i=Math.asin(SlidePadding/CenterPaddingRadius)+Math.PI,t.arc(CenterX,CenterY,CenterPaddingRadius,e.CurrentTheta+HalfTheta-i,e.CurrentTheta-HalfTheta+i,!0),t.closePath(),t.lineWidth=frameBorderWidth,t.strokeStyle=frameBorderColor,t.stroke(),t.clip(),n=e.Image.naturalHeight<=e.Image.naturalWidth?MinImageDimension/e.Image.naturalHeight:MinImageDimension/e.Image.naturalWidth;var a=e.Image.naturalWidth*n,r=e.Image.naturalHeight*n,d=e.CenterX-a/2,o=e.CenterY-r/2;t.beginPath(),0==e.Image.naturalWidth&&0==e.Image.naturalHeight||t.drawImage(e.Image,d,o,a,r),t.restore()}catch(e){myAlert("RenderRoundedSlide():"),myAlert(e)}}function RenderSlide(e){try{var t,n=getContext();n.save(),n.beginPath(),n.moveTo(e.BaseLeftPointX,e.BaseLeftPointY),n.lineTo(e.TopLeftPointX,e.TopLeftPointY),n.lineTo(e.TopRightPointX,e.TopRightPointY),n.lineTo(e.BaseRightPointX,e.BaseRightPointY),n.lineTo(e.BaseLeftPointX,e.BaseLeftPointY),n.closePath(),n.lineWidth=frameBorderWidth,n.strokeStyle=frameBorderColor,n.stroke(),n.clip(),myAlert(e.Image.naturalHeight),t=e.Image.naturalHeight<=e.Image.naturalWidth?MinImageDimension/e.Image.naturalHeight:MinImageDimension/e.Image.naturalWidth;var i=e.Image.naturalWidth*t,a=e.Image.naturalHeight*t,r=e.CenterX-i/2,d=e.CenterY-a/2;n.beginPath(),0==e.Image.naturalWidth&&0==e.Image.naturalHeight||n.drawImage(e.Image,r,d,i,a),n.restore()}catch(e){myAlert("RenderSlide():"),myAlert(e)}}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};var HalfTheta,HalfBaseLength,HalfTopLength,CenterX=0,CenterY=0,WheelRadius=200,CenterPaddingRadius=100,GridMode=!1,IsRounded=!1,HasLabels=!1,WheelBeginTheta=0,WheelEndTheta=Math.PI,SubDivisions=12,SlidePadding=10,AnimationSpeed=80,StepSizeAcceleration=8e-4,MasterTheta=0,StepSize=.01,Slides=[];function getContext(){return getCanvas().getContext("2d")}function getCanvas(){return document.getElementById("slideshow-wheel-widget-container")}function DeriveVariables(){HalfTheta=Math.PI/SubDivisions,HalfBaseLength=CenterPaddingRadius*Math.tan(HalfTheta),HalfTopLength=WheelRadius*Math.tan(HalfTheta)}function Animate(){try{ClearCanvas(),Update(),RenderSlides(),GridMode&&RenderGrid(),HasLabels&&RenderLabels(),setTimeout(function(){Animate()},AnimationSpeed)}catch(e){myAlert("Animate():"),myAlert(e)}}function ClearCanvas(){getContext().clearRect(0,0,getCanvas().width,getCanvas().height)}function Update(){(MasterTheta+=StepSize)>2*Math.PI&&(MasterTheta-=2*Math.PI),MasterTheta<-2*Math.PI&&(MasterTheta+=2*Math.PI),UpdateSlides()}function TestEnoughImages(){}function TestImageOrder(){for(var e=0;e<Slides.length;++e);}!function(){var e=getCanvas();null!=e&&(myAlert("Adding Listener..."),e.addEventListener("reload",ReloadUserInputs,!1)),GetProvidedParams(),GetStyles(),DeriveVariables(),LoadImages(),CreateSlides(),Animate()}();